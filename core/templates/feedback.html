{% extends 'base.html' %}
{% load static %}

{% block title %}Submit Feedback - Babatngon CMS{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section-modern" style="padding: 80px 0 40px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
    <div class="container">
        <div class="row justify-content-center text-center">
            <div class="col-lg-8">
                <h1 class="display-4 fw-bold text-white mb-3">We Value Your Feedback</h1>
                <p class="lead text-white opacity-90">
                    Help us improve our system by sharing your experience and suggestions
                </p>
            </div>
        </div>
    </div>
</section>

<!-- Feedback Form Section -->
<section class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <!-- Info Cards -->
                <div class="row g-3 mb-4">
                    <div class="col-md-4">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-body text-center">
                                <i class="bi bi-lightbulb text-warning fs-1 mb-3"></i>
                                <h6 class="fw-semibold">Share Ideas</h6>
                                <p class="text-muted small mb-0">Suggest new features or improvements</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-body text-center">
                                <i class="bi bi-bug text-danger fs-1 mb-3"></i>
                                <h6 class="fw-semibold">Report Issues</h6>
                                <p class="text-muted small mb-0">Help us fix bugs and problems</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="card border-0 shadow-sm h-100">
                            <div class="card-body text-center">
                                <i class="bi bi-star text-primary fs-1 mb-3"></i>
                                <h6 class="fw-semibold">Rate Experience</h6>
                                <p class="text-muted small mb-0">Tell us how we're doing</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Feedback Form Card -->
                <div class="card border-0 shadow-sm">
                    <div class="card-body p-4 p-md-5">
                        <h4 class="fw-bold mb-4">Submit Your Feedback</h4>
                        
                        <form method="POST" action="{% url 'feedback' %}" id="feedbackForm">
                            {% csrf_token %}
                            
                            <!-- Personal Information -->
                            <div class="row g-3 mb-4">
                                <div class="col-md-6">
                                    <label for="name" class="form-label fw-semibold">
                                        Full Name <span class="text-danger">*</span>
                                    </label>
                                    <input type="text" class="form-control form-control-lg" id="name" name="name" 
                                           placeholder="Enter your full name" required>
                                </div>
                                <div class="col-md-6">
                                    <label for="email" class="form-label fw-semibold">
                                        Email Address <span class="text-danger">*</span>
                                    </label>
                                    <input type="email" class="form-control form-control-lg" id="email" name="email" 
                                           placeholder="your.email@example.com" required>
                                </div>
                            </div>

                            <!-- Feedback Category -->
                            <div class="mb-4">
                                <label for="category" class="form-label fw-semibold">
                                    Feedback Category <span class="text-danger">*</span>
                                </label>
                                <select class="form-select form-select-lg" id="category" name="category" required>
                                    <option value="">Select a category...</option>
                                    <option value="general">General Feedback</option>
                                    <option value="complaint">Complaint System</option>
                                    <option value="assistance">Assistance Request</option>
                                    <option value="interface">User Interface</option>
                                    <option value="performance">System Performance</option>
                                    <option value="suggestion">Suggestion</option>
                                    <option value="bug">Bug Report</option>
                                    <option value="other">Other</option>
                                </select>
                            </div>

                            <!-- Rating -->
                            <div class="mb-4">
                                <label class="form-label fw-semibold">
                                    Overall Experience Rating <span class="text-danger">*</span>
                                </label>
                                <div class="rating-container">
                                    <div class="btn-group w-100" role="group">
                                        <input type="radio" class="btn-check" name="rating" id="rating1" value="1" required>
                                        <label class="btn btn-outline-danger" for="rating1">
                                            <i class="bi bi-star-fill"></i><br>
                                            <small>Very Poor</small>
                                        </label>

                                        <input type="radio" class="btn-check" name="rating" id="rating2" value="2">
                                        <label class="btn btn-outline-warning" for="rating2">
                                            <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><br>
                                            <small>Poor</small>
                                        </label>

                                        <input type="radio" class="btn-check" name="rating" id="rating3" value="3">
                                        <label class="btn btn-outline-info" for="rating3">
                                            <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><br>
                                            <small>Average</small>
                                        </label>

                                        <input type="radio" class="btn-check" name="rating" id="rating4" value="4">
                                        <label class="btn btn-outline-primary" for="rating4">
                                            <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><br>
                                            <small>Good</small>
                                        </label>

                                        <input type="radio" class="btn-check" name="rating" id="rating5" value="5">
                                        <label class="btn btn-outline-success" for="rating5">
                                            <i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><i class="bi bi-star-fill"></i><br>
                                            <small>Excellent</small>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <!-- Subject -->
                            <div class="mb-4">
                                <label for="subject" class="form-label fw-semibold">
                                    Subject <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control form-control-lg" id="subject" name="subject" 
                                       placeholder="Brief subject of your feedback" required maxlength="200">
                            </div>

                            <!-- Message -->
                            <div class="mb-4">
                                <label for="message" class="form-label fw-semibold">
                                    Your Feedback <span class="text-danger">*</span>
                                </label>
                                <textarea class="form-control" id="message" name="message" rows="6" 
                                          placeholder="Please provide detailed feedback about your experience..." required></textarea>
                                <div class="form-text">Be as specific as possible to help us understand and address your feedback.</div>
                            </div>

                            <!-- Submit Button -->
                            <div class="d-grid gap-2">
                                <button type="submit" class="btn btn-modern btn-modern-primary btn-lg">
                                    <i class="bi bi-send me-2"></i>Submit Feedback
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Additional Info -->
                <div class="alert alert-info mt-4">
                    <div class="d-flex">
                        <i class="bi bi-info-circle fs-4 me-3"></i>
                        <div>
                            <h6 class="alert-heading fw-semibold mb-2">Your Privacy Matters</h6>
                            <p class="mb-0 small">
                                Your feedback is valuable to us. We will review your submission and may contact you 
                                via email if we need additional information. Your personal information will be kept confidential 
                                and used solely for improving our system.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Statistics Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row text-center">
            <div class="col-lg-3 col-md-6 mb-4 mb-lg-0">
                <div class="stat-card">
                    <i class="bi bi-chat-dots text-primary fs-1 mb-3"></i>
                    <h3 class="fw-bold">{{ total_feedback }}</h3>
                    <p class="text-muted mb-0">Total Feedbacks</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-4 mb-lg-0">
                <div class="stat-card">
                    <i class="bi bi-star-fill text-warning fs-1 mb-3"></i>
                    <h3 class="fw-bold">{{ average_rating|floatformat:1 }}</h3>
                    <p class="text-muted mb-0">Average Rating</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-4 mb-lg-0">
                <div class="stat-card">
                    <i class="bi bi-people text-success fs-1 mb-3"></i>
                    <h3 class="fw-bold">{{ active_users }}</h3>
                    <p class="text-muted mb-0">Active Users</p>
                </div>
            </div>
            <div class="col-lg-3 col-md-6">
                <div class="stat-card">
                    <i class="bi bi-check-circle text-info fs-1 mb-3"></i>
                    <h3 class="fw-bold">{{ resolved_cases }}</h3>
                    <p class="text-muted mb-0">Resolved Cases</p>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<style>
    .rating-container .btn-check:checked + .btn {
        transform: scale(1.05);
    }
    .rating-container .btn {
        transition: all 0.2s ease;
    }
    .rating-container .btn:hover {
        transform: translateY(-2px);
    }
    .stat-card {
        padding: 20px;
        transition: transform 0.3s ease;
    }
    .stat-card:hover {
        transform: translateY(-5px);
    }
</style>

<script>
    // Form validation feedback
    document.getElementById('feedbackForm').addEventListener('submit', function(e) {
        const form = this;
        if (!form.checkValidity()) {
            e.preventDefault();
            e.stopPropagation();
        }
        form.classList.add('was-validated');
    });

    // Rating button animation
    document.querySelectorAll('input[name="rating"]').forEach(radio => {
        radio.addEventListener('change', function() {
            const label = document.querySelector(`label[for="${this.id}"]`);
            label.style.transform = 'scale(1.1)';
            setTimeout(() => {
                label.style.transform = 'scale(1.05)';
            }, 200);
        });
    });
</script>
{% endblock %}
